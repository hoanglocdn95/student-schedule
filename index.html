<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="q3logo.png" />
    <title>Đăng nhập</title>
    <style>
      body {
        text-align: center;
        font-family: Arial, sans-serif;
      }
      input {
        padding: 8px;
        width: 250px;
        margin: 10px 0;
        display: block;
        margin-left: auto;
        margin-right: auto;
      }
      button {
        padding: 10px 20px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h2>Vui lòng nhập email và mật khẩu để đăng nhập</h2>
    <input
      type="email"
      id="emailInput"
      placeholder="Nhập email của bạn"
      required
    />
    <input
      type="password"
      id="passwordInput"
      placeholder="Nhập mật khẩu"
      required
    />
    <button onclick="login()">Đăng nhập</button>

    <script>
      async function login() {
        const email = document.getElementById("emailInput").value.trim();
        const password = document.getElementById("passwordInput").value.trim();

        if (email === "" || password === "") {
          alert("Vui lòng nhập email và mật khẩu!");
          return;
        }
        const GOOGLE_API_URL =
          "https://script.google.com/macros/s/AKfycbxmzfrfln9353b2U9BtA8D0tVdvDg-y-_KP3Vem-79bcXuJON3krz8IBldtp_1EDQCd-Q/exec";

        try {
          const response = await fetch(GOOGLE_API_URL, {
            redirect: "follow",
            method: "POST",
            headers: { "Content-Type": "text/plain;charset=utf-8" },
            body: JSON.stringify({ type: "login", email, password }),
          });

          if (!response.ok) {
            throw new Error("Server không phản hồi đúng!");
          }

          const result = await response.json();
          const res = JSON.parse(result.message);
          const status = res.status;

          switch (status) {
            case "wrong_password":
              alert("Sai mật khẩu! Vui lòng thử lại.");
              break;
            case "email_not_found":
              alert("Email chưa tồn tại trong hệ thống.");
              break;
            case "ok":
              window.location.href = "user-info.html";
              break;
            default:
              alert("Đã xảy ra lỗi, vui lòng thử lại.");
              break;
          }
        } catch (error) {
          console.error("Lỗi:", error);
        }
      }
    </script>
  </body>
</html>
